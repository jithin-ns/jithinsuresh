(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"o7N+":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var a=n("uY3Z"),i=n("xauc"),r=n("fXoL"),s=n("bP2Y");let o=(()=>{class t{constructor(t){this.httpService=t,this.offeringPrefix="offering",this.namePrefix="name",this.starPrefix="star",this.separator="_"}getAllOfferings(t){return this.httpService.httpRequest(t?a.a.offerings+"?page="+t.page+"&limit="+t.limit+"&search="+t.search+"&orderBy="+t.sortBy+"&sortOrder="+t.sortOrder:a.a.offerings,"get")}getAllStars(){return this.httpService.httpRequest(a.a.stars,"get")}getOfferingConfigName(t){return this.offeringPrefix+this.separator+t}getPersonConfigName(t,e){return this.namePrefix+this.separator+t+this.separator+e}getStarConfigName(t,e){return this.starPrefix+this.separator+t+this.separator+e}OfferingDataToCart(t,e){let n=[];if(t)return Object.keys(t).forEach(a=>{const r=a.split(this.separator)[1];if(a.indexOf(this.namePrefix)>-1){const s=a.split(this.separator)[2];let o={offering:null,persons:[]};n[r]=n[r]?n[r]:o,n[r].offering=Object.assign(Object.assign({},t[this.offeringPrefix+this.separator+r]),{offeringDate:e[r].offeringDate?e[r].offeringDate:Object(i.e)()}),n[r].persons[s]={name:t[this.namePrefix+this.separator+r+this.separator+s],star:t[this.starPrefix+this.separator+r+this.separator+s]}}}),n=n.filter(t=>(t.persons=t.persons.filter(t=>null!==t),null!==t)),n}submitUserOffering(t){return this.httpService.httpRequest(a.a.submitOfferings,"post",t)}getTransactionDetails(t){return this.httpService.httpRequest(a.a.transactionDetails+"/"+t,"get")}getTransactionAmount(t){let e=0;return t.offerings.forEach(t=>{e+=t.price*t.devotees.length}),e}completeTransaction(t){return this.httpService.httpRequest(a.a.approveTransaction,"patch",{transactionId:t})}deleteOffering(t){return this.httpService.httpRequest(a.a.offerings+"/"+t.id,"delete")}addOffering(t){return this.httpService.httpRequest(a.a.offerings,t.id?"put":"post",t)}getOfferingDetails(t){return this.httpService.httpRequest(a.a.offerings+"/"+t,"get")}getExistingDevotees(t){return this.httpService.httpRequest(a.a.submitOfferings+"/"+t,"get")}getOfferingsHistory(t,e){let n=a.a.offeringHistory;return n+="?fromDate="+t,n+="&toDate="+e,this.httpService.httpRequest(n,"get")}}return t.\u0275fac=function(e){return new(e||t)(r.Yb(s.a))},t.\u0275prov=r.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},rsga:function(t,e,n){"use strict";n.r(e),n.d(e,"HistoryModule",function(){return I});var a=n("ofXK"),i=n("sYmb"),r=n("1kSV"),s=n("tyNb"),o=n("3Pt+"),c=n("UvjE"),f=n("DFWg"),l=n("xauc"),p=n("wd/R"),g=n("fXoL"),b=n("B43R"),d=n("uY3Z"),u=n("bP2Y");let m=(()=>{class t{constructor(t){this.httpService=t}getAllTransactions(t,e,n){let a=n?d.a.transactionDetails+"?page="+n.page+"&limit="+n.limit+"&search="+n.search+"&orderBy="+n.sortBy+"&sortOrder="+n.sortOrder:d.a.transactionDetails;return a+="&fromDate="+t,a+="&toDate="+e,this.httpService.httpRequest(a,"get")}}return t.\u0275fac=function(e){return new(e||t)(g.Yb(u.a))},t.\u0275prov=g.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var h=n("1R7j"),v=n("SqtC"),y=n("o7N+"),x=n("F4oO");function R(t,e){if(1&t&&(g.Rb(0,"div",18),g.Mb(1,"app-image-icon",14),g.ec(2,"translate"),g.Rb(3,"span",19),g.yc(4),g.Qb(),g.Qb()),2&t){const t=g.dc();g.yb(1),g.ic("url","phone.png")("alternateText",g.fc(2,4,"pages.offerings.offering"))("parentClass","phone"),g.yb(3),g.Ac(" ",null==t.transaction?null:t.transaction.phnNumber," ")}}function O(t,e){if(1&t&&(g.Rb(0,"div",26),g.Mb(1,"app-image-icon",14),g.ec(2,"translate"),g.Rb(3,"label",27),g.yc(4),g.Qb(),g.Qb()),2&t){const t=e.$implicit;g.yb(1),g.ic("url","user.png")("alternateText",g.fc(2,5,"pages.cart.person"))("parentClass","person-cart"),g.yb(3),g.Bc(" ",t.name,", ",t.star," ")}}function Q(t,e){if(1&t&&(g.Rb(0,"div",20),g.Rb(1,"div",21),g.Rb(2,"div",22),g.Mb(3,"app-image-icon",14),g.ec(4,"translate"),g.Rb(5,"label",23),g.yc(6),g.Qb(),g.Qb(),g.Rb(7,"div",22),g.Rb(8,"label",24),g.yc(9),g.Qb(),g.Qb(),g.Qb(),g.wc(10,O,5,7,"div",25),g.Qb()),2&t){const t=e.$implicit;g.yb(3),g.ic("url","offerings.png")("alternateText",g.fc(4,6,"pages.offerings.offering"))("parentClass","offering-history-item"),g.yb(3),g.Ac(" ",t.offering," "),g.yb(3),g.Ac(" ",t.offeringDate," "),g.yb(1),g.ic("ngForOf",t.devotees)}}const C=function(t){return{expanded:t}};let w=(()=>{class t{constructor(t,e){this.router=t,this.offeringsService=e,this.currency=f.b,this.transactionAmount=null,this.expanded=!1}ngOnChanges(){this.transaction&&(this.transactionAmount=this.offeringsService.getTransactionAmount(this.transaction))}navigateToDetails(){const t=[v.d,v.u,v.l,btoa(this.transaction.transactionId)].join("/");this.router.navigateByUrl(t)}}return t.\u0275fac=function(e){return new(e||t)(g.Lb(s.b),g.Lb(y.a))},t.\u0275cmp=g.Fb({type:t,selectors:[["app-transaction-list-item"]],inputs:{transaction:"transaction"},features:[g.wb],decls:29,vars:22,consts:[[1,"w-100","py-1","transaction-list-item-container"],[1,"card"],[1,"card-body"],[1,"row"],[1,"col-12","d-flex","justify-content-between","align-items-start"],[1,"font-weight-bold"],["class","d-flex",4,"ngIf"],[1,"col-12","mt-3","d-flex","justify-content-between","align-items-center"],[1,"font-weight-bold","transaction-amount"],[1,"m-0","py-0","px-2","text-capitalize",3,"type","dismissible"],[1,"col-12","mt-3","py-2","expand-details"],[1,"col-8","d-flex","justify-content-start","align-items-center"],[1,"col-2","d-flex","justify-content-center","align-items-center"],["href","javascript:void(0);",1,"float-right",3,"click"],[3,"url","alternateText","parentClass"],["href","javascript:void(0);",1,"float-left",3,"click"],[1,"col-12","transaction-details",3,"ngClass"],["class","row pb-2",4,"ngFor","ngForOf"],[1,"d-flex"],[1,"ml-2","mt-1","phn-number"],[1,"row","pb-2"],[1,"col-12","d-flex","justify-content-between","align-items-end"],[1,"d-flex","align-items-end"],[1,"mb-0","ml-2","offering-label"],[1,"mb-0","offering-label"],["class","col-12 d-flex align-items-end pl-4 ml-4 py-1",4,"ngFor","ngForOf"],[1,"col-12","d-flex","align-items-end","pl-4","ml-4","py-1"],[1,"mb-0","ml-2","devotee-label"]],template:function(t,e){1&t&&(g.Rb(0,"div",0),g.Rb(1,"div",1),g.Rb(2,"div",2),g.Rb(3,"div",3),g.Rb(4,"div",4),g.Rb(5,"span",5),g.yc(6),g.Qb(),g.wc(7,R,5,6,"div",6),g.Qb(),g.Rb(8,"div",7),g.Rb(9,"div"),g.Rb(10,"span",8),g.yc(11),g.Qb(),g.Qb(),g.Rb(12,"ngb-alert",9),g.yc(13),g.Qb(),g.Qb(),g.Rb(14,"div",10),g.Rb(15,"div",3),g.Rb(16,"div",11),g.Rb(17,"span"),g.yc(18),g.Qb(),g.Qb(),g.Rb(19,"div",12),g.Rb(20,"a",13),g.bc("click",function(){return e.navigateToDetails()}),g.Mb(21,"app-image-icon",14),g.ec(22,"translate"),g.Qb(),g.Qb(),g.Rb(23,"div",12),g.Rb(24,"a",15),g.bc("click",function(){return e.expanded=!e.expanded}),g.Mb(25,"app-image-icon",14),g.ec(26,"translate"),g.Qb(),g.Qb(),g.Qb(),g.Qb(),g.Rb(27,"div",16),g.wc(28,Q,11,8,"div",17),g.Qb(),g.Qb(),g.Qb(),g.Qb(),g.Qb()),2&t&&(g.yb(6),g.zc(null==e.transaction?null:e.transaction.transactionId),g.yb(1),g.ic("ngIf",null==e.transaction?null:e.transaction.phnNumber),g.yb(4),g.Bc(" ",e.currency," ",e.transactionAmount,"/- "),g.yb(1),g.ic("type",null!=e.transaction&&e.transaction.status&&"complete"===(null==e.transaction?null:e.transaction.status)?"success":"warning")("dismissible",!1),g.yb(1),g.Ac(" ",null==e.transaction?null:e.transaction.status," "),g.yb(5),g.zc(null==e.transaction?null:e.transaction.time),g.yb(3),g.ic("url","edit.png")("alternateText",g.fc(22,16,"pages.offerings.offering"))("parentClass","phone"),g.yb(4),g.ic("url",e.expanded?"up.png":"down.png")("alternateText",g.fc(26,18,"pages.offerings.offering"))("parentClass","phone"),g.yb(2),g.ic("ngClass",g.mc(20,C,e.expanded)),g.yb(1),g.ic("ngForOf",null==e.transaction?null:e.transaction.offerings))},directives:[a.k,r.c,x.a,a.i,a.j],pipes:[i.d],styles:[".transaction-list-item-container[_ngcontent-%COMP%]   .phn-number[_ngcontent-%COMP%]{font-size:14px}.transaction-list-item-container[_ngcontent-%COMP%]   .transaction-amount[_ngcontent-%COMP%]{font-size:16px}.transaction-list-item-container[_ngcontent-%COMP%]   .expand-details[_ngcontent-%COMP%]{border-top:1px solid #ccc}.transaction-list-item-container[_ngcontent-%COMP%]   .transaction-details[_ngcontent-%COMP%]{height:0;max-height:0;overflow:hidden;transition:max-height .5s}.transaction-list-item-container[_ngcontent-%COMP%]   .transaction-details.expanded[_ngcontent-%COMP%]{height:auto;overflow-y:auto;max-height:500px}"]}),t})();function _(t,e){1&t&&g.Mb(0,"app-transaction-list-item",14),2&t&&g.ic("transaction",e.$implicit)}function D(t,e){1&t&&(g.Rb(0,"div",15),g.Rb(1,"label",16),g.yc(2,"general.nothingToList"),g.Qb(),g.Qb())}const j=[{path:"",component:(()=>{class t{constructor(t,e,n){this.translate=t,this.utilsService=e,this.transactionsService=n,this.transactions=[],this.formGroup=new o.f({}),this.pageOptions={search:"",page:1,limit:f.e,sortBy:"id",sortOrder:"desc"}}ngOnInit(){this.translate.get(["pages.admin.search","pages.admin.sortBy","pages.admin.regionalName","pages.admin.englishName","pages.admin.price","pages.admin.ascending","pages.admin.descending","pages.admin.from","pages.admin.to"]).subscribe(t=>{this.setupSearchForm(t)}),this.getTransactions()}setupSearchForm(t){this.formConfig={search:{type:"text",name:"search",placeholder:t["pages.admin.search"],tabIndex:"0"},from:{type:"date",name:"fromDate",label:t["pages.admin.from"],placeholder:t["pages.admin.from"],defaultValue:Object(l.e)(),feed:{formControl:"toDate",property:"maxDate"},tabIndex:"0",parentClass:"m-0"},to:{type:"date",name:"toDate",label:t["pages.admin.to"],placeholder:t["pages.admin.to"],defaultValue:Object(l.e)(),feed:{formControl:"fromDate",property:"minDate"},maxDate:Object(l.e)(),tabIndex:"1",parentClass:"m-0"}},this.formGroup=Object(l.d)([this.formConfig.search,this.formConfig.from,this.formConfig.to],this.formGroup),this.formGroup.get("search").valueChanges.subscribe(t=>{t?(this.pageOptions.search=t,this.getTransactions()):(this.pageOptions.search="",this.getTransactions())})}getTransactions(){let t=this.formGroup.get("fromDate").value?Object(l.a)(this.formGroup.get("fromDate").value):Object(l.a)(),e=this.formGroup.get("toDate").value?Object(l.a)(this.formGroup.get("toDate").value):Object(l.a)();const n=this.utilsService.date(t).startOf("day").format(c.c),a=this.utilsService.date(e).endOf("day").format(c.c);this.transactionsService.getAllTransactions(n,a,this.pageOptions).subscribe(t=>{const e=this.utilsService.getLanguageExtension();this.transactions=t&&t.data?function(t,e){let n=[];return t&&Array.isArray(t)&&(n=t.map(t=>({transactionId:t.transaction_id?t.transaction_id:0,status:t.transaction_status?t.transaction_status:"",time:t.transaction_time?p(t.transaction_time).format(c.b):null,userId:t.user_id?t.user_id:0,phnNumber:t.phone_number?t.phone_number:"",offerings:t.offerings?t.offerings.map(t=>({offeringId:t.offering_id?t.offering_id:0,offering:t["offering"+e]?t["offering"+e]:"",price:t.price?t.price:0,offeringDate:t.offering_date?p(t.offering_date).format(c.a):"",devotees:t.devotees?t.devotees.map(t=>({devoteeId:t.devotee_id?t.devotee_id:0,name:t.name?t.name:"",starId:t.star_id?t.star_id:0,star:t["star"+e]?t["star"+e]:""})):[]})):[]}))),n}(t.data,e):[]})}}return t.\u0275fac=function(e){return new(e||t)(g.Lb(i.e),g.Lb(b.a),g.Lb(m))},t.\u0275cmp=g.Fb({type:t,selectors:[["app-history"]],decls:20,vars:8,consts:[[1,"w-100","h-100","d-flex","flex-column","history-container"],[1,"row"],[1,"col-12","py-4","text-center"],["translate","",1,"h4"],[1,"row","mb-2"],[1,"col-6"],["appFormElement","",1,"w-100",3,"config","group"],[1,"row","justify-content-end"],[1,"col-4"],["type","button","translate","",1,"btn","btn-success","tms-button","search-btn",3,"click"],[1,"col-12","mt-3"],[1,"col-12"],[3,"transaction",4,"ngFor","ngForOf"],["class","col-12 pt-4 text-center",4,"ngIf"],[3,"transaction"],[1,"col-12","pt-4","text-center"],["translate","",1,"h5"]],template:function(t,e){1&t&&(g.Rb(0,"div",0),g.Rb(1,"div",1),g.Rb(2,"div",2),g.Rb(3,"p",3),g.yc(4,"pages.admin.transactions"),g.Qb(),g.Qb(),g.Qb(),g.Rb(5,"div",4),g.Rb(6,"div",5),g.Nb(7,6),g.Qb(),g.Rb(8,"div",5),g.Nb(9,6),g.Qb(),g.Qb(),g.Rb(10,"div",7),g.Rb(11,"div",8),g.Rb(12,"button",9),g.bc("click",function(){return e.getTransactions()}),g.yc(13," pages.admin.search "),g.Qb(),g.Qb(),g.Rb(14,"div",10),g.Nb(15,6),g.Qb(),g.Qb(),g.Rb(16,"div",1),g.Rb(17,"div",11),g.wc(18,_,1,1,"app-transaction-list-item",12),g.Qb(),g.wc(19,D,3,0,"div",13),g.Qb(),g.Qb()),2&t&&(g.yb(7),g.ic("config",e.formConfig.from)("group",e.formGroup),g.yb(2),g.ic("config",e.formConfig.to)("group",e.formGroup),g.yb(6),g.ic("config",e.formConfig.search)("group",e.formGroup),g.yb(3),g.ic("ngForOf",e.transactions),g.yb(1),g.ic("ngIf",!e.transactions||!e.transactions.length))},directives:[i.a,h.a,a.j,a.k,w],styles:[".history-container[_ngcontent-%COMP%]   .search-btn[_ngcontent-%COMP%]{padding:7px;display:flex;justify-content:center;align-items:center}"]}),t})()}];let S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.Jb({type:t}),t.\u0275inj=g.Ib({imports:[[s.e.forChild(j)],s.e]}),t})();var P=n("biST"),T=n("omz/");let I=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.Jb({type:t}),t.\u0275inj=g.Ib({imports:[[a.b,i.c,r.d,r.j,S,P.a,T.a]]}),t})()}}]);