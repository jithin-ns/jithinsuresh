(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"5/bF":function(t,e,a){"use strict";a.r(e),a.d(e,"DashboardModule",function(){return C});var n=a("ofXK"),r=a("sYmb"),o=a("tyNb"),i=a("3Pt+"),s=a("UvjE"),c=a("DFWg"),b=a("wd/R"),d=a("xauc"),f=a("fXoL"),l=a("B43R"),m=a("uY3Z"),u=a("bP2Y");let g=(()=>{class t{constructor(t){this.httpService=t}getDashboardInformation(t,e){let a=m.a.dashboard;return a+="?fromDate="+t,a+="&toDate="+e,this.httpService.httpRequest(a,"get")}}return t.\u0275fac=function(e){return new(e||t)(f.Yb(u.a))},t.\u0275prov=f.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var h=a("1R7j");function p(t,e){if(1&t&&(f.Rb(0,"div",21),f.Nb(1,3),f.Qb()),2&t){const t=e.$implicit,a=f.dc();f.yb(1),f.ic("config",t)("group",a.formGroup)}}function y(t,e){1&t&&(f.Rb(0,"div",22),f.Rb(1,"div",23),f.yc(2," pages.offerings.offering "),f.Qb(),f.Rb(3,"div",24),f.yc(4," pages.admin.count "),f.Qb(),f.Rb(5,"div",25),f.yc(6," pages.admin.revenue "),f.Qb(),f.Qb())}function v(t,e){if(1&t&&(f.Rb(0,"div",22),f.Rb(1,"div",26),f.yc(2),f.Qb(),f.Rb(3,"div",27),f.yc(4),f.Qb(),f.Rb(5,"div",28),f.yc(6),f.Qb(),f.Qb()),2&t){const t=e.$implicit;f.yb(1),f.jc("title",t.offering),f.yb(1),f.Ac(" ",t.offering," "),f.yb(2),f.Ac(" ",t.count," "),f.yb(2),f.Ac(" ",t.revenue," ")}}function O(t,e){1&t&&(f.Rb(0,"div",22),f.Rb(1,"div",29),f.Rb(2,"label",30),f.yc(3,"general.nothingToList"),f.Qb(),f.Qb(),f.Qb())}const R=function(t){return{"d-none":t}},D=[{path:"",component:(()=>{class t{constructor(t,e,a){this.translate=t,this.utilsService=e,this.dashboardService=a,this.formGroup=new i.f({}),this.currency=c.b,this.dashboardData={revenue:0,offeringSummary:[]},this.revenueByOffering=0,this.dateRangeText=""}ngOnInit(){this.translate.get(["pages.admin.from","pages.admin.to","pages.offerings.offering","pages.admin.dateRange","pages.admin.currentMonth","pages.admin.lastThreeMonths","pages.admin.lastSixMonths","pages.admin.currentYear","pages.admin.financialYear"]).subscribe(t=>{this.filterOptions=[{value:"currentMonth",label:t["pages.admin.currentMonth"]},{value:"lastThreeMonths",label:t["pages.admin.lastThreeMonths"]},{value:"lastSixMonths",label:t["pages.admin.lastSixMonths"]},{value:"currentYear",label:t["pages.admin.currentYear"]},{value:"financialYear",label:t["pages.admin.financialYear"]}],this.setUpForm(t)})}setUpForm(t){this.formConfig=[{type:"date",name:"fromDate",label:t["pages.admin.from"],placeholder:t["pages.admin.from"],defaultValue:Object(d.e)(),feed:{formControl:"toDate",property:"maxDate"},tabIndex:"0",parentClass:"m-0"},{type:"date",name:"toDate",label:t["pages.admin.to"],placeholder:t["pages.admin.to"],defaultValue:Object(d.e)(),feed:{formControl:"fromDate",property:"minDate"},maxDate:Object(d.e)(),tabIndex:"1",parentClass:"m-0"}],this.filterFormConfig={type:"select",name:"dateOptions",defaultValue:"",placeholder:t["pages.admin.dateRange"],tabIndex:"2",options:this.filterOptions,parentClass:"m-0"},this.formGroup=Object(d.d)(this.formConfig,this.formGroup),this.formGroup=Object(d.d)([this.filterFormConfig],this.formGroup),this.formGroup.get("dateOptions").valueChanges.subscribe(t=>{this.getDashboardInformation()}),this.getDashboardInformation()}getDate(){const t=this.formGroup.get("dateOptions").value;let e={fromDate:"",toDate:""};if(t)e=function(t){let e=b().startOf("day"),a=b().endOf("day");switch(t){case"currentMonth":e=b().startOf("month"),a=b().endOf("day");break;case"lastThreeMonths":e=b().subtract(3,"months").startOf("month"),a=b().subtract(1,"months").endOf("month");break;case"lastSixMonths":e=b().subtract(6,"months").startOf("month"),a=b().subtract(1,"months").endOf("month");break;case"currentYear":e=b().startOf("year"),a=b().endOf("day");break;case"financialYear":const t=Number(b().format("M"))>=c.d?b().format("yyyy"):b().subtract(1,"years").format("yyyy");e=b([t,c.d-1]).startOf("month"),a=b().endOf("day")}return{fromDate:e.format(s.c),toDate:a.format(s.c)}}(t);else{let t=this.formGroup.get("fromDate").value?Object(d.a)(this.formGroup.get("fromDate").value):Object(d.a)(),a=this.formGroup.get("toDate").value?Object(d.a)(this.formGroup.get("toDate").value):Object(d.a)();e={fromDate:this.utilsService.date(t).startOf("day").format(s.c),toDate:this.utilsService.date(a).endOf("day").format(s.c)}}return e}getDashboardInformation(){const t=this.getDate();this.dateRangeText=this.utilsService.date(t.fromDate).format(s.a)+" - "+this.utilsService.date(t.toDate).format(s.a),this.dashboardService.getDashboardInformation(t.fromDate,t.toDate).subscribe(t=>{const e=this.utilsService.getLanguageExtension();this.dashboardData=function(t,e){let a={revenue:0,offeringSummary:[]};return t&&t.totalRevenue&&t.summary&&(a={revenue:t.totalRevenue.revenue?t.totalRevenue.revenue:0,offeringSummary:t.summary&&Array.isArray(t.summary)?t.summary.map(t=>({count:t.count?t.count:0,offering:t["offering"+e]?t["offering"+e]:"",revenue:t.revenue?t.revenue:0})):[]}),a}(t.data,e)})}}return t.\u0275fac=function(e){return new(e||t)(f.Lb(r.e),f.Lb(l.a),f.Lb(g))},t.\u0275cmp=f.Fb({type:t,selectors:[["app-dashboard"]],decls:31,vars:18,consts:[[1,"row","h-100","dashboard-container"],[1,"col-12"],[1,"row","mb-1"],["appFormElement","",3,"config","group"],[1,"row",3,"ngClass"],["class","col-6 mb-2",4,"ngFor","ngForOf"],[1,"row","justify-content-end",3,"ngClass"],[1,"col-4"],["type","button","translate","",1,"btn","btn-success","tms-button","dashboard-search",3,"click"],[1,"col-12","font-weight-bold","pb-2","text-right","font-italic"],[1,"w-100","my-2"],[1,"card"],[1,"card-body","d-flex","justify-content-center","align-items-center"],["translate","",1,"revenue-label","mr-4"],[1,"revenue-amount","ml-4","text-center"],[1,"card-body"],[1,"w-100"],[1,"pb-4","text-center"],["translate","",1,"revenue-label"],["class","row",4,"ngIf"],["class","row",4,"ngFor","ngForOf"],[1,"col-6","mb-2"],[1,"row"],["translate","",1,"col-5","pb-2","font-weight-bold","text-ellipsis","summary-heading"],["translate","",1,"col-3","pb-2","font-weight-bold","text-center","text-ellipsis","summary-heading"],["translate","",1,"col-4","pb-2","font-weight-bold","text-center","text-ellipsis","summary-heading"],[1,"col-5","py-1","text-ellipsis","summary-text",3,"title"],[1,"col-3","py-1","text-center","text-ellipsis","summary-text"],[1,"col-4","py-1","text-center","text-ellipsis","summary-text"],[1,"col-12","py-1","text-center"],["translate",""]],template:function(t,e){1&t&&(f.Rb(0,"div",0),f.Rb(1,"div",1),f.Rb(2,"div",2),f.Rb(3,"div",1),f.Nb(4,3),f.Qb(),f.Qb(),f.Rb(5,"div",4),f.wc(6,p,2,2,"div",5),f.Qb(),f.Rb(7,"div",6),f.Rb(8,"div",7),f.Rb(9,"button",8),f.bc("click",function(){return e.getDashboardInformation()}),f.yc(10," pages.admin.search "),f.Qb(),f.Qb(),f.Qb(),f.Rb(11,"div",4),f.Rb(12,"div",9),f.yc(13),f.Qb(),f.Qb(),f.Rb(14,"div",10),f.Rb(15,"div",11),f.Rb(16,"div",12),f.Rb(17,"span",13),f.yc(18," pages.admin.totalRevenue "),f.Qb(),f.Rb(19,"span",14),f.yc(20),f.Qb(),f.Qb(),f.Qb(),f.Qb(),f.Rb(21,"div",10),f.Rb(22,"div",11),f.Rb(23,"div",15),f.Rb(24,"div",16),f.Rb(25,"div",17),f.Rb(26,"span",18),f.yc(27," pages.admin.offeringSummary "),f.Qb(),f.Qb(),f.wc(28,y,7,0,"div",19),f.wc(29,v,7,4,"div",20),f.wc(30,O,4,0,"div",19),f.Qb(),f.Qb(),f.Qb(),f.Qb(),f.Qb(),f.Qb()),2&t&&(f.yb(4),f.ic("config",e.filterFormConfig)("group",e.formGroup),f.yb(1),f.ic("ngClass",f.mc(12,R,""!==e.formGroup.get("dateOptions").value)),f.yb(1),f.ic("ngForOf",e.formConfig),f.yb(1),f.ic("ngClass",f.mc(14,R,""!==e.formGroup.get("dateOptions").value)),f.yb(4),f.ic("ngClass",f.mc(16,R,""===e.formGroup.get("dateOptions").value)),f.yb(2),f.zc(e.dateRangeText),f.yb(7),f.Bc(" ",e.currency," ",e.dashboardData.revenue,"/- "),f.yb(8),f.ic("ngIf",(null==e.dashboardData?null:e.dashboardData.offeringSummary)&&e.dashboardData.offeringSummary.length),f.yb(1),f.ic("ngForOf",e.dashboardData.offeringSummary),f.yb(1),f.ic("ngIf",!(null!=e.dashboardData&&e.dashboardData.offeringSummary&&e.dashboardData.offeringSummary.length)))},directives:[h.a,n.i,n.j,r.a,n.k],styles:[".dashboard-container[_ngcontent-%COMP%]   .dashboard-search[_ngcontent-%COMP%]{padding:5px;display:flex;justify-content:center;align-items:center}.dashboard-container[_ngcontent-%COMP%]   .revenue-label[_ngcontent-%COMP%]{font-size:16px;font-weight:700}.dashboard-container[_ngcontent-%COMP%]   .revenue-amount[_ngcontent-%COMP%], .dashboard-container[_ngcontent-%COMP%]   .revenue-by-offering[_ngcontent-%COMP%]{font-size:30px;font-weight:700}.dashboard-container[_ngcontent-%COMP%]   .summary-heading[_ngcontent-%COMP%]{font-size:14px}.dashboard-container[_ngcontent-%COMP%]   .summary-text[_ngcontent-%COMP%]{font-size:13px}"]}),t})()}];let x=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=f.Jb({type:t}),t.\u0275inj=f.Ib({imports:[[o.e.forChild(D)],o.e]}),t})();var Q=a("biST"),w=a("omz/");let C=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=f.Jb({type:t}),t.\u0275inj=f.Ib({imports:[[n.b,r.c,x,Q.a,w.a]]}),t})()}}]);