(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{b3F3:function(t,n,i){"use strict";i.r(n),i.d(n,"FinalizeModule",function(){return j});var e=i("ofXK"),a=i("sYmb"),o=i("1kSV"),c=i("0hV+"),s=i("tyNb"),r=i("DFWg"),l=i("SqtC"),b=i("N26v"),d=i("ajRT"),u=i("fXoL"),p=i("B43R"),f=i("o7N+"),m=i("uY3Z"),g=i("bP2Y");let y=(()=>{class t{constructor(t){this.httpService=t}getConfig(){return this.httpService.httpRequest(m.a.config,"get")}}return t.\u0275fac=function(n){return new(n||t)(u.Yb(g.a))},t.\u0275prov=u.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function h(t,n){if(1&t&&(u.Rb(0,"div",22),u.Rb(1,"label",23),u.yc(2),u.Qb(),u.Qb()),2&t){const t=n.$implicit;u.yb(2),u.Bc(" ",t.name,", ",t.star," ")}}function v(t,n){if(1&t&&(u.Rb(0,"div",18),u.Rb(1,"div",19),u.Rb(2,"label",20),u.yc(3),u.Qb(),u.Qb(),u.wc(4,h,3,2,"div",21),u.Qb()),2&t){const t=n.$implicit;u.yb(3),u.Ac(" ",t.offering," "),u.yb(1),u.ic("ngForOf",t.devotees)}}const R=function(t){return{id:t}};let Q=(()=>{class t{constructor(t){this.offeringsService=t,this.configurations=null,this.transactionDetails=null,this.totalAmount=0,this.currency=r.b}ngOnChanges(){this.transactionDetails&&(this.totalAmount=this.offeringsService.getTransactionAmount(this.transactionDetails))}}return t.\u0275fac=function(n){return new(n||t)(u.Lb(f.a))},t.\u0275cmp=u.Fb({type:t,selectors:[["app-receipt"]],inputs:{configurations:"configurations",transactionDetails:"transactionDetails"},features:[u.wb],decls:31,vars:10,consts:[[1,"row","text-uppercase","receipt-container"],[1,"col-12"],[1,"receipt-header"],[1,"row","py-2","border-bottom"],[1,"col-12","text-center"],[1,"font-weight-bold","title"],[1,"row","py-2","border-bottom","transaction-details"],["translate","",1,"float-left"],[1,"float-left","px-1"],[1,"float-left"],[1,"float-right"],[1,"float-right","px-1"],["translate","",1,"float-right"],[3,"translate","translateParams"],[1,"row","py-2","border-bottom","receipt-body"],["class","row pb-2",4,"ngFor","ngForOf"],[1,"row","py-2","border-bottom","receipt-amount"],[1,"font-weight-bolder","float-right","total-amount"],[1,"row","pb-2"],[1,"col-12","d-flex","align-items-end"],[1,"mb-1","ml-2","font-weight-bolder","offering-name"],["class","col-12 d-flex align-items-end pl-4 ml-4 py-1",4,"ngFor","ngForOf"],[1,"col-12","d-flex","align-items-end","pl-4","ml-4","py-1"],[1,"mb-0","ml-2","font-weight-bold","devotee-details"]],template:function(t,n){1&t&&(u.Rb(0,"div",0),u.Rb(1,"div",1),u.Rb(2,"div",2),u.Rb(3,"div",1),u.Rb(4,"div",3),u.Rb(5,"div",4),u.Rb(6,"label",5),u.yc(7),u.Qb(),u.Qb(),u.Qb(),u.Rb(8,"div",6),u.Rb(9,"div",1),u.Rb(10,"label",7),u.yc(11,"pages.admin.date"),u.Qb(),u.Rb(12,"label",8),u.yc(13,":"),u.Qb(),u.Rb(14,"label",9),u.yc(15),u.Qb(),u.Rb(16,"label",10),u.yc(17),u.Qb(),u.Rb(18,"label",11),u.yc(19,":"),u.Qb(),u.Rb(20,"label",12),u.yc(21,"pages.admin.time"),u.Qb(),u.Qb(),u.Rb(22,"div",1),u.Mb(23,"label",13),u.Qb(),u.Qb(),u.Qb(),u.Qb(),u.Rb(24,"div",14),u.Rb(25,"div",1),u.wc(26,v,5,2,"div",15),u.Qb(),u.Qb(),u.Rb(27,"div",16),u.Rb(28,"div",1),u.Rb(29,"label",17),u.yc(30),u.Qb(),u.Qb(),u.Qb(),u.Qb(),u.Qb()),2&t&&(u.yb(7),u.zc(null==n.configurations?null:n.configurations.templeName),u.yb(8),u.Ac(" ",null==n.transactionDetails?null:n.transactionDetails.transactionDate," "),u.yb(2),u.Ac(" ",null==n.transactionDetails?null:n.transactionDetails.transactionTime," "),u.yb(6),u.ic("translate","pages.success.transactionId")("translateParams",u.mc(8,R,null==n.transactionDetails?null:n.transactionDetails.transactionId)),u.yb(3),u.ic("ngForOf",null==n.transactionDetails?null:n.transactionDetails.offerings),u.yb(4),u.Bc(" ",n.currency," ",n.totalAmount,"/- "))},directives:[a.a,e.j],styles:[""]}),t})();var w=i("F4oO");function I(t,n){if(1&t&&(u.Rb(0,"div",27),u.Mb(1,"app-image-icon",20),u.ec(2,"translate"),u.Rb(3,"label",28),u.yc(4),u.Qb(),u.Qb()),2&t){const t=n.$implicit;u.yb(1),u.ic("url","user.png")("alternateText",u.fc(2,5,"pages.cart.person"))("parentClass","person-cart"),u.yb(3),u.Bc(" ",t.name,", ",t.star," ")}}function C(t,n){if(1&t){const t=u.Sb();u.Rb(0,"div",17),u.Rb(1,"div",18),u.Rb(2,"div",19),u.Mb(3,"app-image-icon",20),u.ec(4,"translate"),u.Rb(5,"label",21),u.yc(6),u.Qb(),u.Qb(),u.Rb(7,"div",19),u.Rb(8,"label",22),u.yc(9),u.Qb(),u.Qb(),u.Qb(),u.wc(10,I,5,7,"div",23),u.Rb(11,"div",24),u.Rb(12,"a",25),u.bc("click",function(){u.rc(t);const i=n.index;return u.dc().onPrintInvoice(i)}),u.Mb(13,"app-image-icon",20),u.ec(14,"translate"),u.Rb(15,"span",26),u.yc(16,"pages.admin.print"),u.Qb(),u.Qb(),u.Qb(),u.Qb()}if(2&t){const t=n.$implicit;u.yb(3),u.ic("url","offerings.png")("alternateText",u.fc(4,9,"pages.offerings.offering"))("parentClass","offering-cart"),u.yb(3),u.Ac(" ",t.offering," "),u.yb(3),u.Ac(" ",t.offeringDate," "),u.yb(1),u.ic("ngForOf",t.devotees),u.yb(3),u.ic("url","print.png")("alternateText",u.fc(14,11,"pages.admin.print"))("parentClass","person-cart")}}function x(t,n){1&t&&(u.Rb(0,"div",29),u.Rb(1,"div",30),u.Rb(2,"ngb-alert",31),u.yc(3," pages.admin.transactionCompleted "),u.Qb(),u.Qb(),u.Qb()),2&t&&(u.yb(2),u.ic("type","success")("dismissible",!1))}function D(t,n){if(1&t){const t=u.Sb();u.Rb(0,"div",32),u.Rb(1,"div",24),u.Rb(2,"div",33),u.Rb(3,"button",34),u.bc("click",function(){u.rc(t);const n=u.dc(),i=u.qc(21);return n.displayUpiQrCode(i)}),u.yc(4," pages.admin.generateUpiQr "),u.Qb(),u.Qb(),u.Qb(),u.Qb()}}const P=function(t){return[t]};function S(t,n){if(1&t){const t=u.Sb();u.Rb(0,"div",35),u.Rb(1,"div",36),u.Rb(2,"div",33),u.Rb(3,"button",37),u.yc(4," general.back "),u.Qb(),u.Qb(),u.Qb(),u.Rb(5,"div",38),u.Rb(6,"div",33),u.Rb(7,"button",39),u.bc("click",function(){return u.rc(t),u.dc().submit()}),u.yc(8," pages.admin.completeTransaction "),u.Qb(),u.Qb(),u.Qb(),u.Qb()}if(2&t){const t=u.dc();u.yb(3),u.ic("routerLink",u.mc(1,P,t.transactionHistoryRoute))}}function k(t,n){if(1&t){const t=u.Sb();u.Rb(0,"div",40),u.Rb(1,"div",36),u.Rb(2,"div",33),u.Rb(3,"button",37),u.yc(4," general.back "),u.Qb(),u.Qb(),u.Qb(),u.Rb(5,"div",38),u.Rb(6,"div",33),u.Rb(7,"button",39),u.bc("click",function(){return u.rc(t),u.dc().onPrintInvoice()}),u.yc(8," pages.admin.printReceipt "),u.Qb(),u.Qb(),u.Qb(),u.Qb()}if(2&t){const t=u.dc();u.yb(3),u.ic("routerLink",u.mc(1,P,t.transactionHistoryRoute))}}function O(t,n){if(1&t&&(u.Rb(0,"div",41),u.Rb(1,"h4",42),u.yc(2," pages.admin.upi "),u.Qb(),u.Rb(3,"button",43),u.bc("click",function(){return n.$implicit.dismiss("Cross click")}),u.Rb(4,"span",44),u.yc(5,"\xd7"),u.Qb(),u.Qb(),u.Qb(),u.Rb(6,"div",45),u.Rb(7,"div",46),u.Rb(8,"div",47),u.Mb(9,"qrcode",48),u.Rb(10,"label",49),u.yc(11,"pages.admin.scanUsingUpiApp"),u.Qb(),u.Qb(),u.Qb(),u.Qb(),u.Rb(12,"div",50),u.Rb(13,"button",51),u.bc("click",function(){return n.$implicit.close("Save click")}),u.yc(14," general.back "),u.Qb(),u.Qb()),2&t){const t=u.dc();u.yb(9),u.ic("qrdata",t.qrCodeUrl)("width",200)("errorCorrectionLevel","H")}}const F=function(t){return{id:t}},M=[{path:"",component:(()=>{class t{constructor(t,n,i,e,a,o){this.activatedRoute=t,this.modalService=n,this.translate=i,this.utilsService=e,this.offeringsService=a,this.configService=o,this.configurations=null,this.currency=r.b,this.transactionCompleted=!1,this.transactionHistoryRoute=["",l.d,l.v,l.m].join("/"),this.qrCodeUrl=""}ngOnInit(){this.translate.get(["pages.admin.completeTransaction","pages.admin.confirmTransaction","pages.admin.yes","pages.admin.cancel","general.continue","general.failed","pages.admin.transactionIDError"]).subscribe(t=>{this.translations=t}),this.activatedRoute.paramMap.subscribe(t=>{this.transactionId=t.get("transactionId"),this.transactionId&&this.utilsService.isBase64(this.transactionId)&&(this.transactionId=atob(this.transactionId),this.getTransactionDetails())})}generateQrCodeUrl(){this.configService.getConfig().subscribe(t=>{this.configurations=t&&t.data?function(t){let n;return t&&(n={templeName:t.templeName?t.templeName:"",currency:t.currency?t.currency:"",countryCode:t.countryCode?t.countryCode:"",mobilePhoneLocale:t.mobilePhoneLocale?t.mobilePhoneLocale:"",templeEmail:t.templeEmail?t.templeEmail:"",appUrl:t.appUrl?t.appUrl:"",upiId:t.upiId?t.upiId:""}),n}(t.data):null,this.configurations&&this.configurations.upiId&&""!==this.configurations.upiId&&(this.qrCodeUrl=`upi://pay?pn=${this.configurations.upiId}&pa=${this.configurations.upiId}&am=${this.totalAmount}`)})}getTransactionDetails(){const t=this.utilsService.getLanguageExtension();this.offeringsService.getTransactionDetails(this.transactionId).subscribe(n=>{this.transactionDetails=Object(b.i)(n.data,t),this.transactionCompleted=this.transactionDetails.transactionStatus===r.j,this.totalAmount=this.offeringsService.getTransactionAmount(this.transactionDetails),this.generateQrCodeUrl()})}submit(){const t=this.modalService.open(d.a,{centered:!0});t.componentInstance.config={type:"success",title:this.translations["pages.admin.completeTransaction"],body:this.translations["pages.admin.confirmTransaction"],buttons:{cancel:{label:this.translations["pages.admin.cancel"]},submit:{label:this.translations["pages.admin.yes"]}}},t.componentInstance.inputs={transactionId:this.transactionId},t.componentInstance.action.subscribe(n=>{"submit"===n&&this.completeTransaction(),t.close()})}completeTransaction(){this.offeringsService.completeTransaction(this.transactionId).subscribe(t=>{if(t.data&&t.data.transaction_id)this.transactionCompleted=!0;else{const t=this.modalService.open(d.a,{centered:!0});t.componentInstance.config={type:"danger",title:this.translations["general.failed"],body:this.translations["pages.admin.transactionIDError"],buttons:{submit:{label:this.translations["general.continue"]}}},t.componentInstance.action.subscribe(n=>{t.close()})}})}displayUpiQrCode(t){this.modalService.open(t,{centered:!0,ariaLabelledBy:"modal-basic-title"}).result.then(t=>{},t=>{})}onPrintInvoice(t=null){this.transactionDetailsForPrint=Object.assign({},this.transactionDetails),null!==t&&(this.transactionDetailsForPrint.offerings=[this.transactionDetailsForPrint.offerings[t]]),window.print()}}return t.\u0275fac=function(n){return new(n||t)(u.Lb(s.a),u.Lb(o.h),u.Lb(a.e),u.Lb(p.a),u.Lb(f.a),u.Lb(y))},t.\u0275cmp=u.Fb({type:t,selectors:[["app-finalize"]],decls:22,vars:13,consts:[[1,"w-100","h-100","d-flex","flex-column","align-items-center","finalize-transaction-container"],[1,"w-100","px-2"],[1,"row","py-4"],[1,"col-12","d-flex","justify-content-center","py-2","transaction-id"],[1,"text-center",3,"translate","translateParams"],["class","row pb-2",4,"ngFor","ngForOf"],[1,"row","mt-4","mb-2"],[1,"col-12","d-flex","flex-direction-column","align-items-center","amount-summary"],["translate",""],[1,"px-3"],["class","row mt-4",4,"ngIf"],["class","row mb-4",4,"ngIf"],["class","row",4,"ngIf"],["class","row mt-3",4,"ngIf"],[1,"receipt-parent"],[3,"configurations","transactionDetails"],["content",""],[1,"row","pb-2"],[1,"col-12","d-flex","justify-content-between","align-items-end","mb-2"],[1,"d-flex","align-items-end"],[3,"url","alternateText","parentClass"],[1,"ml-3","mb-0","font-weight-bolder"],[1,"mb-1","font-italic","offering-date"],["class","col-12 d-flex align-items-end pl-4 ml-4 py-1",4,"ngFor","ngForOf"],[1,"col-12"],["href","javascript:void(0);",1,"d-flex","align-items-center",3,"click"],["translate","",1,"mt-1","ml-2","offering-date"],[1,"col-12","d-flex","align-items-end","pl-4","ml-4","py-1"],[1,"mb-0","ml-2","font-weight-bold"],[1,"row","mt-4"],[1,"col-12","py-2","text-center"],["translate","",3,"type","dismissible"],[1,"row","mb-4"],[1,"d-flex","justify-content-center"],["type","button","translate","",1,"btn","btn-primary","tms-button",3,"click"],[1,"row"],[1,"col-4"],["type","button","translate","",1,"btn","btn-secondary","tms-button",3,"routerLink"],[1,"col-8"],["type","button","translate","",1,"btn","btn-success","tms-button",3,"click"],[1,"row","mt-3"],[1,"modal-header"],["id","modal-basic-title","translate","",1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"w-100"],[1,"d-flex","flex-column","align-items-center"],[3,"qrdata","width","errorCorrectionLevel"],["translate","",1,"text-center"],[1,"modal-footer"],["type","button","translate","",1,"btn","btn-outline-dark",3,"click"]],template:function(t,n){1&t&&(u.Rb(0,"div",0),u.Rb(1,"div",1),u.Rb(2,"div",2),u.Rb(3,"div",3),u.Mb(4,"label",4),u.Qb(),u.Qb(),u.wc(5,C,17,13,"div",5),u.Rb(6,"div",6),u.Rb(7,"div",7),u.Rb(8,"label",8),u.yc(9,"pages.success.totalAmount"),u.Qb(),u.Rb(10,"label",9),u.yc(11,":"),u.Qb(),u.Rb(12,"label"),u.yc(13),u.Qb(),u.Qb(),u.Qb(),u.wc(14,x,4,2,"div",10),u.wc(15,D,5,0,"div",11),u.wc(16,S,9,3,"div",12),u.wc(17,k,9,3,"div",13),u.Qb(),u.Qb(),u.Rb(18,"div",14),u.Mb(19,"app-receipt",15),u.Qb(),u.wc(20,O,15,3,"ng-template",null,16,u.xc)),2&t&&(u.yb(4),u.ic("translate","pages.success.transactionId")("translateParams",u.mc(11,F,n.transactionId)),u.yb(1),u.ic("ngForOf",null==n.transactionDetails?null:n.transactionDetails.offerings),u.yb(8),u.Bc("",n.currency," ",n.totalAmount,"/-"),u.yb(1),u.ic("ngIf",n.transactionCompleted),u.yb(1),u.ic("ngIf",n.qrCodeUrl),u.yb(1),u.ic("ngIf",!n.transactionCompleted),u.yb(1),u.ic("ngIf",n.transactionCompleted),u.yb(2),u.ic("configurations",n.configurations)("transactionDetails",n.transactionDetailsForPrint))},directives:[a.a,e.j,e.k,Q,w.a,o.c,s.c,c.a],pipes:[a.d],styles:[".finalize-transaction-container[_ngcontent-%COMP%]   .offering-date[_ngcontent-%COMP%]{font-size:14px;color:#000}.finalize-transaction-container[_ngcontent-%COMP%]   .amount-summary[_ngcontent-%COMP%]{display:flex;justify-content:center}.finalize-transaction-container[_ngcontent-%COMP%]   .amount-summary[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:25px;font-weight:700}.finalize-transaction-container[_ngcontent-%COMP%]   .transaction-id[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:22px;font-weight:700}.receipt-parent[_ngcontent-%COMP%]{display:none}"]}),t})()}];let T=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=u.Jb({type:t}),t.\u0275inj=u.Ib({imports:[[s.e.forChild(M)],s.e]}),t})();var L=i("omz/"),A=i("VqSJ");let j=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=u.Jb({type:t}),t.\u0275inj=u.Ib({imports:[[e.b,o.i,o.d,a.c,c.b,L.a,A.a,T]]}),t})()}}]);