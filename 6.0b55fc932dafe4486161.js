(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{N26v:function(e,t,i){"use strict";i.d(t,"c",function(){return a}),i.d(t,"a",function(){return f}),i.d(t,"f",function(){return c}),i.d(t,"g",function(){return g}),i.d(t,"h",function(){return l}),i.d(t,"e",function(){return d}),i.d(t,"i",function(){return u}),i.d(t,"b",function(){return b}),i.d(t,"d",function(){return p});var n=i("UvjE"),r=i("DFWg"),o=i("wd/R"),s=i("xauc");function a(e){let t=[];return e&&Array.isArray(e)&&(t=e.map(e=>({offering:Number(e.offering.value.id),offeringDate:e.offering.offeringDate?o(Object(s.a)(e.offering.offeringDate)).startOf("day").format(n.c):o().startOf("day").format(n.c),persons:e.persons.map(e=>({name:e.name,star:Number(e.star.value)}))}))),t}function f(e){let t;return e&&(t={offeringEn:e.nameEnglish?e.nameEnglish:"",offeringRg:e.nameRegional?e.nameRegional:e.nameEnglish?e.nameEnglish:"",description:e.description?e.description:"",price:e.amount?Number(e.amount):0}),t}function c(e,t){return e.map(e=>({label:e["offering"+t]?e["offering"+t]:"",value:{id:e.id?e.id:0,label:e["offering"+t]?e["offering"+t]:"",price:e.price?e.price:0}}))}function g(e,t){return e.map(e=>({label:e["star"+t]?e["star"+t]:"",value:{label:e["star"+t]?e["star"+t]:"",value:e.id?e.id:0}}))}function l(e,t){let i=null;return e&&(i={transactionId:e.transaction_id?e.transaction_id:"",transactionStatus:e.transaction_status?e.transaction_status:r.k,transactionDate:e.transaction_time?o(e.transaction_time).format(n.a):"",transactionTime:e.transaction_time?o(e.transaction_time).format(n.d):"",offerings:e.offerings?e.offerings.map(e=>({offering:e["offering"+t]?e["offering"+t]:"",offeringId:e.offering_id?e.offering_id:0,price:e.price?e.price:0,offeringDate:e.offering_date?o(e.offering_date).format(n.a):"",devotees:e.devotees?e.devotees.map(e=>({devoteeId:e.devotee_id?e.devotee_id:0,name:e.name?e.name:"",starId:e.star_id?e.star_id:"",star:e["star"+t]?e["star"+t]:""})):[]})):[]}),i}function d(e){return e.map(e=>({id:e.id?e.id:0,offering_en:e.offering_en?e.offering_en:"",offering_rg:e.offering_rg?e.offering_rg:"",description:e.description?e.description:"",price:e.price?e.price:0}))}function u(e){return{offeringEn:e.offering_en?e.offering_en:"",offeringRg:e.offering_rg?e.offering_rg:"",description:e.description?e.description:"",price:e.price?Number(e.price):0}}function b(e,t){let i=[];return e&&Array.isArray(e)&&(i=e.map(e=>({name:e.name?e.name:"",star:e["star"+t]?e["star"+t]:"",starId:e.star_id?e.star_id:0}))),i}function p(e,t){let i=[];return e&&Array.isArray(e)&&(i=e.map(e=>({offeringId:e.offering_id?e.offering_id:0,offering:e["offering"+t]?e["offering"+t]:"",devoteeId:e.devotee_id?e.devotee_id:0,devotee:e.name?e.name:"",starId:e.star_id?e.star_id:0,star:e["star"+t]?e["star"+t]:"",offeringDate:e.offering_date?o(e.offering_date).format(n.a):"",amount:e.amount?e.amount:0,userId:e.user_id?e.user_id:0,phoneNumber:e.phone_number?e.phone_number:"",bookingDate:e.created_time?o(e.created_time).format(n.a):"",status:e.status?e.status:"",isAdvanceBooking:!(!e.offering_date||!e.created_time)&&o(e.offering_date).isAfter(e.created_time,"day")}))),i}},"o7N+":function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i("uY3Z"),r=i("xauc"),o=i("fXoL"),s=i("bP2Y");let a=(()=>{class e{constructor(e){this.httpService=e,this.offeringPrefix="offering",this.namePrefix="name",this.starPrefix="star",this.separator="_"}getAllOfferings(e){return this.httpService.httpRequest(e?n.a.offerings+"?page="+e.page+"&limit="+e.limit+"&search="+e.search+"&orderBy="+e.sortBy+"&sortOrder="+e.sortOrder:n.a.offerings,"get")}getAllStars(){return this.httpService.httpRequest(n.a.stars,"get")}getOfferingConfigName(e){return this.offeringPrefix+this.separator+e}getPersonConfigName(e,t){return this.namePrefix+this.separator+e+this.separator+t}getStarConfigName(e,t){return this.starPrefix+this.separator+e+this.separator+t}OfferingDataToCart(e,t){let i=[];if(e)return Object.keys(e).forEach(n=>{const o=n.split(this.separator)[1];if(n.indexOf(this.namePrefix)>-1){const s=n.split(this.separator)[2];let a={offering:null,persons:[]};i[o]=i[o]?i[o]:a,i[o].offering=Object.assign(Object.assign({},e[this.offeringPrefix+this.separator+o]),{offeringDate:t[o].offeringDate?t[o].offeringDate:Object(r.e)()}),i[o].persons[s]={name:e[this.namePrefix+this.separator+o+this.separator+s],star:e[this.starPrefix+this.separator+o+this.separator+s]}}}),i=i.filter(e=>(e.persons=e.persons.filter(e=>null!==e),null!==e)),i}submitUserOffering(e){return this.httpService.httpRequest(n.a.submitOfferings,"post",e)}getTransactionDetails(e){return this.httpService.httpRequest(n.a.transactionDetails+"/"+e,"get")}getTransactionAmount(e){let t=0;return e.offerings.forEach(e=>{t+=e.price*e.devotees.length}),t}completeTransaction(e){return this.httpService.httpRequest(n.a.approveTransaction,"patch",{transactionId:e})}deleteOffering(e){return this.httpService.httpRequest(n.a.offerings+"/"+e.id,"delete")}addOffering(e){return this.httpService.httpRequest(n.a.offerings,e.id?"put":"post",e)}getOfferingDetails(e){return this.httpService.httpRequest(n.a.offerings+"/"+e,"get")}getExistingDevotees(e){return this.httpService.httpRequest(n.a.submitOfferings+"/"+e,"get")}getOfferingsHistory(e,t){let i=n.a.offeringHistory;return i+="?fromDate="+e,i+="&toDate="+t,this.httpService.httpRequest(i,"get")}}return e.\u0275fac=function(t){return new(t||e)(o.Yb(s.a))},e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},vbIl:function(e,t,i){"use strict";i.r(t),i.d(t,"OfferingsModule",function(){return T});var n=i("ofXK"),r=i("tyNb"),o=i("3Pt+"),s=i("52Kp"),a=i("DFWg"),f=i("e8pF"),c=i("SqtC"),g=i("xauc"),l=i("N26v"),d=i("fXoL"),u=i("sYmb"),b=i("1R7j");let p=(()=>{class e{constructor(e){this.translate=e,this.offeringDate=null,this.advanceBookingFormGroup=new o.f({}),this.offeringDateObj=new d.n}ngOnInit(){this.translate.get(["pages.admin.date","form.validationErrors.mandatory"]).subscribe(e=>{this.initialize(e)})}initialize(e){this.advanceBookingFormConfig={type:"date",name:"offeringDate",label:e["pages.admin.date"],placeholder:e["pages.admin.date"],defaultValue:this.offeringDate?this.offeringDate:Object(g.e)(),minDate:Object(g.e)(),tabIndex:"0",parentClass:"m-0",validators:[Object.assign(Object.assign({},g.c.required),{validationMsg:e["form.validationErrors.mandatory"]})]},this.advanceBookingFormGroup=Object(g.d)([this.advanceBookingFormConfig],this.advanceBookingFormGroup)}cancel(){this.offeringDateObj.emit({action:"cancel",date:null})}setOfferingDate(){const e={action:"submit",date:this.advanceBookingFormGroup.get("offeringDate").value};this.offeringDateObj.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(u.e))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-advance-booking"]],inputs:{offeringDate:"offeringDate"},outputs:{offeringDateObj:"offeringDateObj"},decls:16,vars:2,consts:[[1,"modal-content"],[1,"modal-header"],["translate","",1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],[1,"col-12"],["appFormElement","",3,"config","group"],[1,"modal-footer"],["type","button","translate","",1,"btn","btn-light","px-4",3,"click"],["type","button","translate","",1,"btn","btn-success","px-4",3,"click"]],template:function(e,t){1&e&&(d.Rb(0,"div",0),d.Rb(1,"div",1),d.Rb(2,"h5",2),d.yc(3,"pages.offerings.advanceBooking"),d.Qb(),d.Rb(4,"button",3),d.bc("click",function(){return t.cancel()}),d.Rb(5,"span",4),d.yc(6,"\xd7"),d.Qb(),d.Qb(),d.Qb(),d.Rb(7,"div",5),d.Rb(8,"div",6),d.Rb(9,"div",7),d.Nb(10,8),d.Qb(),d.Qb(),d.Qb(),d.Rb(11,"div",9),d.Rb(12,"button",10),d.bc("click",function(){return t.cancel()}),d.yc(13," general.cancel "),d.Qb(),d.Rb(14,"button",11),d.bc("click",function(){return t.setOfferingDate()}),d.yc(15," general.submit "),d.Qb(),d.Qb(),d.Qb()),2&e&&(d.yb(10),d.ic("config",t.advanceBookingFormConfig)("group",t.advanceBookingFormGroup))},directives:[u.a,b.a],styles:[""]}),e})();var m=i("UvjE"),h=i("1kSV"),v=i("o7N+"),y=i("B43R"),O=i("qfBg"),x=i("F4oO");function R(e,t){if(1&e){const e=d.Sb();d.Rb(0,"div",10),d.Rb(1,"label",11),d.Rb(2,"span",12),d.yc(3),d.Qb(),d.Rb(4,"span",13),d.yc(5),d.Qb(),d.Qb(),d.Rb(6,"button",14),d.bc("click",function(){d.rc(e);const i=t.$implicit;return d.dc().selectDevotee(i)}),d.yc(7," pages.offerings.select "),d.Qb(),d.Qb()}if(2&e){const e=t.$implicit;d.yb(3),d.Ac("",e.name,", "),d.yb(2),d.zc(e.star)}}let k=(()=>{class e{constructor(){this.action=new d.n}ngOnInit(){}cancelClick(){this.action.emit(null)}selectDevotee(e){this.action.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=d.Fb({type:e,selectors:[["app-existing-devotees"]],outputs:{action:"action"},decls:13,vars:1,consts:[[1,"modal-content","existing-devotees"],[1,"modal-header"],["translate","",1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],["class","col-12 d-flex align-items-center justify-content-between py-1 my-1 devotee-item",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button","translate","",1,"btn","btn-light","px-4",3,"click"],[1,"col-12","d-flex","align-items-center","justify-content-between","py-1","my-1","devotee-item"],[1,"m-0"],[1,"font-weight-bold","devotee-name"],[1,"devotee-star"],["type","button","translate","",1,"btn","btn-success","px-4",3,"click"]],template:function(e,t){1&e&&(d.Rb(0,"div",0),d.Rb(1,"div",1),d.Rb(2,"h5",2),d.yc(3,"pages.offerings.chooseFromExisting"),d.Qb(),d.Rb(4,"button",3),d.bc("click",function(){return t.cancelClick()}),d.Rb(5,"span",4),d.yc(6,"\xd7"),d.Qb(),d.Qb(),d.Qb(),d.Rb(7,"div",5),d.Rb(8,"div",6),d.wc(9,R,8,2,"div",7),d.Qb(),d.Qb(),d.Rb(10,"div",8),d.Rb(11,"button",9),d.bc("click",function(){return t.cancelClick()}),d.yc(12," pages.admin.cancel "),d.Qb(),d.Qb(),d.Qb()),2&e&&(d.yb(9),d.ic("ngForOf",t.existingDevotees))},directives:[u.a,n.j],styles:[".existing-devotees[_ngcontent-%COMP%]   .devotee-item[_ngcontent-%COMP%]   .devotee-name[_ngcontent-%COMP%]{font-weight:600!important;font-size:17px}.existing-devotees[_ngcontent-%COMP%]   .devotee-item[_ngcontent-%COMP%]   .devotee-star[_ngcontent-%COMP%]{font-size:14px}"]}),e})();function D(e,t){if(1&e){const e=d.Sb();d.Rb(0,"a",9),d.bc("click",function(){d.rc(e);const t=d.dc(2).index;return d.dc().deletePerson(t)}),d.Mb(1,"app-image-icon",10),d.ec(2,"translate"),d.Qb()}2&e&&(d.yb(1),d.ic("url","delete_cross.png")("alternateText",d.fc(2,3,"general.delete"))("parentClass","person-cart"))}function S(e,t){if(1&e){const e=d.Sb();d.Rb(0,"a",11),d.bc("click",function(){d.rc(e);const t=d.dc(2).index;return d.dc().chooseFromExisting(t)}),d.Rb(1,"span",12),d.yc(2,"pages.offerings.chooseFromExisting"),d.Qb(),d.Qb()}}function C(e,t){if(1&e&&(d.Rb(0,"div"),d.Rb(1,"div",6),d.wc(2,D,3,5,"a",7),d.wc(3,S,3,0,"a",8),d.Qb(),d.Nb(4,2),d.Nb(5,2),d.Qb()),2&e){const e=d.dc(),t=e.index,i=e.$implicit,n=d.dc();d.yb(2),d.ic("ngIf",t>0),d.yb(1),d.ic("ngIf",n.existingDevotees&&n.existingDevotees.length),d.yb(1),d.ic("config",i.name)("group",n.formGroup),d.yb(1),d.ic("config",i.star)("group",n.formGroup)}}const _=function(e,t){return{"py-2":e,odd:t}};function Q(e,t){if(1&e&&(d.Rb(0,"div",4),d.wc(1,C,6,6,"div",5),d.Qb()),2&e){const e=t.$implicit;d.ic("ngClass",d.nc(2,_,e.active,t.odd)),d.yb(1),d.ic("ngIf",e.active)}}let j=(()=>{class e{constructor(e){this.modalService=e,this.offeringDeleted=new d.n,this.assetsBasePath=a.a}ngOnInit(){}deletePerson(e){this.formConfig.persons[e].active=!1,this.formGroup.removeControl(this.formConfig.persons[e].name.name),this.formGroup.removeControl(this.formConfig.persons[e].star.name),this.offeringDeleted.emit(!0)}chooseFromExisting(e){const t=this.modalService.open(k,{centered:!0});t.componentInstance.existingDevotees=this.existingDevotees,t.componentInstance.action.subscribe(i=>{if(i){const t={label:i.star,value:i.starId};this.formGroup.get(this.formConfig.persons[e].name.name).setValue(i.name),this.formGroup.get(this.formConfig.persons[e].star.name).setValue(t)}t.close()})}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(h.h))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-offering-form"]],inputs:{formConfig:"formConfig",formGroup:"formGroup",existingDevotees:"existingDevotees"},outputs:{offeringDeleted:"offeringDeleted"},decls:4,vars:3,consts:[[1,"row"],[1,"col-12"],["appFormElement","",3,"config","group"],["class","col-12 border-div",3,"ngClass",4,"ngFor","ngForOf"],[1,"col-12","border-div",3,"ngClass"],[4,"ngIf"],[1,"w-100","px-0","d-inline-block"],["href","javascript: void(0)","class","float-left delete-link",3,"click",4,"ngIf"],["href","javascript: void(0)","class","float-right choose-existing-text",3,"click",4,"ngIf"],["href","javascript: void(0)",1,"float-left","delete-link",3,"click"],[3,"url","alternateText","parentClass"],["href","javascript: void(0)",1,"float-right","choose-existing-text",3,"click"],["translate",""]],template:function(e,t){1&e&&(d.Rb(0,"div",0),d.Rb(1,"div",1),d.Nb(2,2),d.Qb(),d.wc(3,Q,2,5,"div",3),d.Qb()),2&e&&(d.yb(2),d.ic("config",null==t.formConfig?null:t.formConfig.offering)("group",t.formGroup),d.yb(1),d.ic("ngForOf",null==t.formConfig?null:t.formConfig.persons))},directives:[b.a,n.j,n.i,n.k,x.a,u.a],pipes:[u.d],styles:[".choose-existing-text[_ngcontent-%COMP%], .delete-link[_ngcontent-%COMP%]{font-size:13px}.odd[_ngcontent-%COMP%]{background-color:#f2ecec}"]}),e})();function w(e,t){if(1&e){const e=d.Sb();d.Rb(0,"a",20),d.bc("click",function(){d.rc(e);const t=d.dc(3).index;return d.dc().deleteOffering(t)}),d.Mb(1,"app-image-icon",21),d.ec(2,"translate"),d.Qb()}2&e&&(d.yb(1),d.ic("url","delete_cross.png")("alternateText",d.fc(2,3,"general.delete"))("parentClass","person-cart"))}function I(e,t){if(1&e&&(d.Rb(0,"button",17),d.yc(1),d.Qb(),d.Rb(2,"span",18),d.yc(3),d.Qb(),d.wc(4,w,3,5,"a",19)),2&e){const e=d.dc(2).$implicit,t=d.dc();d.yb(1),d.Ac(" ",e.index," "),d.yb(2),d.zc(e.title),d.yb(1),d.ic("ngIf",t.validOfferings>1)}}function P(e,t){1&e&&d.wc(0,I,5,3,"ng-template",16)}function G(e,t){if(1&e&&(d.Rb(0,"div",30),d.Rb(1,"label",31),d.yc(2," pages.offerings.offeringTotal "),d.Qb(),d.Rb(3,"label",32),d.yc(4),d.Qb(),d.Qb()),2&e){const e=d.dc(3).$implicit,t=d.dc();d.yb(4),d.Bc(" ",t.currency," ",e.totalAmount,"/- ")}}function E(e,t){if(1&e){const e=d.Sb();d.Rb(0,"app-offering-form",23),d.bc("offeringDeleted",function(){d.rc(e);const t=d.dc(2).index;return d.dc().calculateOfferingPrice(t)}),d.Qb(),d.wc(1,G,5,2,"div",24),d.Rb(2,"div",25),d.Rb(3,"button",26),d.bc("click",function(){d.rc(e);const t=d.dc(2),i=t.index,n=t.$implicit;return d.dc().addPersons(i,n.persons.length)}),d.yc(4," pages.offerings.addPerson "),d.Qb(),d.Qb(),d.Rb(5,"div",27),d.Rb(6,"span",28),d.yc(7),d.Qb(),d.Rb(8,"a",29),d.bc("click",function(){d.rc(e);const t=d.dc(2).index;return d.dc().openAdvanceBookingForm(t)}),d.yc(9," pages.offerings.advanceBooking "),d.Qb(),d.Qb()}if(2&e){const e=d.dc(2).$implicit,t=d.dc();d.ic("formConfig",e)("formGroup",t.formGroup)("existingDevotees",t.existingDevotees),d.yb(1),d.ic("ngIf",e.totalAmount),d.yb(6),d.Ac(" ",e.offeringDateText," ")}}function F(e,t){1&e&&d.wc(0,E,10,5,"ng-template",22)}function A(e,t){if(1&e&&(d.Rb(0,"ngb-panel",14),d.wc(1,P,1,0,void 0,15),d.wc(2,F,1,0,void 0,15),d.Qb()),2&e){const e=t.$implicit;d.kc("id","accordion-",t.index,""),d.jc("cardClass",e.active?"":"d-none"),d.yb(1),d.ic("ngIf",e.active),d.yb(1),d.ic("ngIf",e.active)}}const N=[{path:"",component:(()=>{class e{constructor(e,t,i,n,r,s){this.router=e,this.translate=t,this.modalService=i,this.offeringsService=n,this.utilsService=r,this.userService=s,this.formGroup=new o.f({}),this.offerings=[],this.assetsBasePath=a.a,this.validOfferings=0,this.existingDevotees=[],this.currency=a.b,this.isLoggedIn=!1}ngOnInit(){this.isLoggedIn=this.userService.isAuthenticated(),this.translate.get(["pages.offerings.offering","pages.offerings.name","pages.offerings.star","pages.admin.date","form.validationErrors.mandatory"]).subscribe(e=>{this.translations=e,this.initialize()})}initialize(){return e=this,void 0,i=function*(){yield this.getAllOfferings(),yield this.getAllStars(),this.utilsService.getStorageValue(f.e)&&this.getExistingDevotees(),this.utilsService.getStorageValue(f.c)&&this.utilsService.isBase64(this.utilsService.getStorageValue(f.c))?(JSON.parse(s.a.decode(this.utilsService.getStorageValue(f.c))).forEach((e,t)=>{this.addOffering(t,e.offering),e.persons.forEach((e,i)=>{this.addPersons(t,i,e)})}),this.utilsService.removeStorageValue(f.c)):this.addOffering(0)},new((t=void 0)||(t=Promise))(function(n,r){function o(e){try{a(i.next(e))}catch(t){r(t)}}function s(e){try{a(i.throw(e))}catch(t){r(t)}}function a(e){var i;e.done?n(e.value):(i=e.value,i instanceof t?i:new t(function(e){e(i)})).then(o,s)}a((i=i.apply(e,[])).next())});var e,t,i}getExistingDevotees(){const e=this.utilsService.getStorageValue(f.e),t=this.utilsService.getLanguageExtension();this.offeringsService.getExistingDevotees(e).subscribe(e=>{this.existingDevotees=e&&e.data?Object(l.b)(e.data,t):[]})}getAllOfferings(){return new Promise(e=>{this.offeringsService.getAllOfferings().subscribe(t=>{const i=this.utilsService.getLanguageExtension();this.offeringList=t&&t.data?Object(l.f)(t.data,i):[],e(1)})})}getAllStars(){return new Promise(e=>{this.offeringsService.getAllStars().subscribe(t=>{const i=this.utilsService.getLanguageExtension();this.starsList=t&&t.data?Object(l.g)(t.data,i):[],e(1)})})}addOffering(e,t=null){const i=this.offeringsService.getOfferingConfigName(e),n={type:"autocomplete",name:i,placeholder:this.translations["pages.offerings.offering"],defaultValue:t,tabIndex:"0",options:this.offeringList,validators:[Object.assign(Object.assign({},g.c.required),{validationMsg:this.translations["form.validationErrors.mandatory"]})]},r={index:e+1,active:!0,title:t?t.label:"",offering:n,persons:[],totalAmount:0,offeringDate:t?t.offeringDate:Object(g.e)(),offeringDateText:""};this.formGroup=Object(g.d)([r.offering],this.formGroup),this.offerings.push(r),this.formGroup.get(i).valueChanges.subscribe(t=>{t&&t.label&&t.value?(this.calculateOfferingPrice(e),this.offerings[e].title=t.label):this.offerings[e].title=""}),this.activeId="accordion-"+e.toString(),this.resetIndex(),t||this.addPersons(e,0)}calculateOfferingPrice(e){const t=this.offeringsService.getOfferingConfigName(e),i=this.formGroup.get(t).value;if(i&&i.value){const t=this.offerings[e].persons.filter(e=>e.active).length;this.offerings[e].totalAmount=i.value.price*t}else this.offerings[e].totalAmount=0}addPersons(e,t,i=null){const n={active:!0,name:{type:"text",name:this.offeringsService.getPersonConfigName(e,t),defaultValue:i&&i.name?i.name:"",placeholder:this.translations["pages.offerings.name"],tabIndex:"0",validators:[Object.assign(Object.assign({},g.c.required),{validationMsg:this.translations["form.validationErrors.mandatory"]})]},star:{type:"select",name:this.offeringsService.getStarConfigName(e,t),defaultValue:i&&i.star?i.star:"",placeholder:this.translations["pages.offerings.star"],tabIndex:"0",options:this.starsList,validators:[Object.assign(Object.assign({},g.c.required),{validationMsg:this.translations["form.validationErrors.mandatory"]})]}};this.formGroup=Object(g.d)([n.name,n.star],this.formGroup),this.offerings[e].persons.push(n),this.calculateOfferingPrice(e)}deleteOffering(e){this.offerings[e].active=!1;const t=this.offeringsService.getOfferingConfigName(e);this.formGroup.removeControl(t),this.offerings[e].persons.forEach(e=>{this.formGroup.removeControl(e.name.name),this.formGroup.removeControl(e.star.name)}),this.resetIndex()}openAdvanceBookingForm(e){const t=this.modalService.open(p,{centered:!0});t.componentInstance.offeringDate=this.offerings[e].offeringDate,t.componentInstance.offeringDateObj.subscribe(i=>{if("submit"===i.action)if(this.offerings[e].offeringDate=i.date,JSON.stringify(Object(g.e)())===JSON.stringify(i.date))this.offerings[e].offeringDateText="";else{const t=Object(g.a)(i.date);this.offerings[e].offeringDateText=this.utilsService.date(t).format(m.a)}t.close()})}resetIndex(){let e=0;this.offerings.forEach(t=>{t.active&&(t.index=++e),this.validOfferings=e})}submit(){if(this.formGroup.valid){const e=this.offeringsService.OfferingDataToCart(this.formGroup.value,this.offerings);this.utilsService.setStorageValue(f.c,s.a.encode(JSON.stringify(e)));const t=this.isLoggedIn?[c.d,c.e].join("/"):c.e;this.router.navigate([[t].join("/")])}else{this.formGroup=Object(g.f)(this.formGroup);let e=0,t=0;for(let i of this.offerings){if(i.active){if(this.formGroup.get(i.offering.name).invalid){e=t;break}for(let n of i.persons)if(n.active&&(this.formGroup.get(n.name.name).invalid||this.formGroup.get(n.star.name).invalid)){e=t;break}}t++}this.activeId="accordion-"+e.toString()}}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(r.b),d.Lb(u.e),d.Lb(h.h),d.Lb(v.a),d.Lb(y.a),d.Lb(O.a))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-offerings"]],decls:19,vars:4,consts:[[1,"w-100","h-100","d-flex","flex-column","justify-content-start","align-items-center","offerings-container"],[1,"w-100","px-2"],[1,"row"],[1,"col-12","py-4","text-center"],["translate","",1,"h4"],["autocomplete","off",3,"formGroup"],[1,"col-12"],[3,"closeOthers","activeIds"],[3,"id","cardClass",4,"ngFor","ngForOf"],[1,"col-12","py-2"],[1,"d-flex","justify-content-center"],["type","button","translate","",1,"btn","btn-primary","tms-button",3,"click"],[1,"col-12","pt-4"],["type","button","translate","",1,"btn","btn-success","tms-button",3,"click"],[3,"id","cardClass"],[4,"ngIf"],["ngbPanelTitle",""],[1,"offering-index","float-left"],[1,"float-left"],["href","javascript: void(0)","class","position-absolute delete-offering",3,"click",4,"ngIf"],["href","javascript: void(0)",1,"position-absolute","delete-offering",3,"click"],[3,"url","alternateText","parentClass"],["ngbPanelContent",""],[3,"formConfig","formGroup","existingDevotees","offeringDeleted"],["class","w-100 mt-2",4,"ngIf"],[1,"w-100"],["type","button","translate","",1,"btn","btn-info","tms-button","mt-2",3,"click"],[1,"w-100","mt-2","d-flex","justify-content-between","align-items-center"],[1,"font-italic"],["href","javascript:void(0);","translate","",1,"advance-booking-link",3,"click"],[1,"w-100","mt-2"],["translate","",1,"float-left","offering-amount"],[1,"float-right","offering-amount"]],template:function(e,t){1&e&&(d.Rb(0,"div",0),d.Rb(1,"div",1),d.Rb(2,"div",2),d.Rb(3,"div",3),d.Rb(4,"p",4),d.yc(5,"pages.offerings.enterOfferigs"),d.Qb(),d.Qb(),d.Qb(),d.Rb(6,"form",5),d.Rb(7,"div",2),d.Rb(8,"div",6),d.Rb(9,"ngb-accordion",7),d.wc(10,A,3,4,"ngb-panel",8),d.Qb(),d.Qb(),d.Rb(11,"div",9),d.Rb(12,"div",10),d.Rb(13,"button",11),d.bc("click",function(){return t.addOffering(t.offerings.length)}),d.yc(14," pages.offerings.addOffering "),d.Qb(),d.Qb(),d.Qb(),d.Rb(15,"div",12),d.Rb(16,"div",10),d.Rb(17,"button",13),d.bc("click",function(){return t.submit()}),d.yc(18," general.submit "),d.Qb(),d.Qb(),d.Qb(),d.Qb(),d.Qb(),d.Qb(),d.Qb()),2&e&&(d.yb(6),d.ic("formGroup",t.formGroup),d.yb(3),d.jc("activeIds",t.activeId),d.ic("closeOthers",!0),d.yb(1),d.ic("ngForOf",t.offerings))},directives:[u.a,o.t,o.l,o.g,h.a,n.j,h.k,n.k,h.m,x.a,h.l,j],pipes:[u.d],styles:[".offerings-container[_ngcontent-%COMP%]   .offering-amount[_ngcontent-%COMP%]{font-weight:700}.offerings-container[_ngcontent-%COMP%]   .advance-booking-link[_ngcontent-%COMP%]{font-size:14px}"]}),e})()}];let B=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Jb({type:e}),e.\u0275inj=d.Ib({imports:[[r.e.forChild(N)],r.e]}),e})();var L=i("biST"),M=i("omz/");let T=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Jb({type:e}),e.\u0275inj=d.Ib({imports:[[n.b,B,u.c,h.b,L.a,M.a]]}),e})()}}]);