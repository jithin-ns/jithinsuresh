(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"2eqO":function(e,t,n){"use strict";n.r(t),n.d(t,"ListModule",function(){return Q});var r=n("ofXK"),i=n("sYmb"),a=n("1kSV"),s=n("tyNb"),o=n("3Pt+"),f=n("DFWg"),c=n("SqtC"),g=n("xauc"),l=n("N26v"),d=n("fXoL"),p=n("o7N+"),u=n("1R7j"),m=n("ajRT"),b=n("F4oO");let h=(()=>{class e{constructor(e,t,n,r){this.router=e,this.modalService=t,this.translate=n,this.offeringsService=r,this.itemDeleted=new d.n,this.currency=f.b}ngOnInit(){this.translate.get(["general.cancel","general.delete","general.confirm","pages.admin.deleteWarning"]).subscribe(e=>{this.translations=e})}edit(){const e=[c.d,c.r,c.h,this.offering.id].join("/");this.router.navigate([e])}confirmDelete(){const e=this.modalService.open(m.a,{centered:!0});e.componentInstance.config={type:"danger",title:this.translations["general.delete"],body:this.translations["pages.admin.deleteWarning"],buttons:{cancel:{label:this.translations["general.cancel"]},submit:{label:this.translations["general.confirm"]}}},e.componentInstance.action.subscribe(t=>{"submit"===t&&this.delete(),e.close()})}delete(){this.offeringsService.deleteOffering(this.offering).subscribe(e=>{this.itemDeleted.emit(!0)})}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(s.b),d.Lb(a.h),d.Lb(i.e),d.Lb(p.a))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-offering-list-item"]],inputs:{offering:"offering"},outputs:{itemDeleted:"itemDeleted"},decls:22,vars:15,consts:[[1,"w-100","py-1","offering-list-item-container"],[1,"card"],[1,"card-body"],[1,"row"],[1,"col-9","d-flex","flex-column","justify-content-center","align-items-start"],[1,"font-weight-bold"],[1,"font-weight-bold","offering-name-regional"],[1,"col-3","d-flex","flex-column","justify-content-center","p-0"],[1,"d-flex"],["href","javascript:void(0);",1,"mr-3",3,"click"],[3,"url","alternateText","parentClass"],["href","javascript:void(0);",3,"click"],[1,"font-weight-bold","offering-amount"],[1,"col-12","pt-2","text-ellipsis","offering-description"],[1,"text-truncate"]],template:function(e,t){1&e&&(d.Rb(0,"div",0),d.Rb(1,"div",1),d.Rb(2,"div",2),d.Rb(3,"div",3),d.Rb(4,"div",4),d.Rb(5,"span",5),d.yc(6),d.Qb(),d.Rb(7,"span",6),d.yc(8),d.Qb(),d.Qb(),d.Rb(9,"div",7),d.Rb(10,"div",8),d.Rb(11,"a",9),d.bc("click",function(){return t.edit()}),d.Mb(12,"app-image-icon",10),d.ec(13,"translate"),d.Qb(),d.Rb(14,"a",11),d.bc("click",function(){return t.confirmDelete()}),d.Mb(15,"app-image-icon",10),d.ec(16,"translate"),d.Qb(),d.Qb(),d.Rb(17,"span",12),d.yc(18),d.Qb(),d.Qb(),d.Rb(19,"div",13),d.Rb(20,"span",14),d.yc(21),d.Qb(),d.Qb(),d.Qb(),d.Qb(),d.Qb(),d.Qb()),2&e&&(d.yb(6),d.zc(null==t.offering?null:t.offering.offering_en),d.yb(2),d.Ac(" ",null==t.offering?null:t.offering.offering_rg," "),d.yb(4),d.ic("url","edit.png")("alternateText",d.fc(13,11,"pages.admin.edit"))("parentClass","edit-offering"),d.yb(3),d.ic("url","trash.png")("alternateText",d.fc(16,13,"pages.admin.edit"))("parentClass","edit-offering"),d.yb(3),d.Bc(" ",t.currency," ",null==t.offering?null:t.offering.price,"/- "),d.yb(3),d.Ac(" ",null==t.offering?null:t.offering.description," "))},directives:[b.a],pipes:[i.d],styles:[".offering-list-item-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border-radius:10px}.offering-list-item-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .offering-name-regional[_ngcontent-%COMP%]{font-size:12px}.offering-list-item-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .offering-amount[_ngcontent-%COMP%]{font-size:20px}.offering-list-item-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .offering-description[_ngcontent-%COMP%]{font-size:13px}"]}),e})();function v(e,t){if(1&e&&(d.Rb(0,"div",9),d.Nb(1,10),d.Qb()),2&e){const e=t.$implicit,n=d.dc();d.yb(1),d.ic("config",e)("group",n.formGroup)}}function O(e,t){if(1&e){const e=d.Sb();d.Rb(0,"app-offering-list-item",11),d.bc("itemDeleted",function(){return d.rc(e),d.dc().getOfferings()}),d.Qb()}2&e&&d.ic("offering",t.$implicit)}function _(e,t){1&e&&(d.Rb(0,"div",12),d.Rb(1,"label",13),d.yc(2,"general.nothingToList"),d.Qb(),d.Qb())}const y=[{path:"",component:(()=>{class e{constructor(e,t,n){this.router=e,this.offeringsService=t,this.translate=n,this.formGroup=new o.f({}),this.pageOptions={search:"",page:1,limit:f.e,sortBy:"offering_rg",sortOrder:"asc"}}ngOnInit(){this.translate.get(["pages.admin.search","pages.admin.sortBy","pages.admin.regionalName","pages.admin.englishName","pages.admin.price","pages.admin.ascending","pages.admin.descending"]).subscribe(e=>{this.setupSearchForm(e)}),this.getOfferings()}setupSearchForm(e){this.formConfig=[{type:"text",name:"search",placeholder:e["pages.admin.search"],tabIndex:"0"},{type:"select",name:"orderBy",placeholder:e["pages.admin.sortBy"],defaultValue:this.pageOptions.sortBy,tabIndex:"1",options:[{label:e["pages.admin.regionalName"],value:"offering_rg"},{label:e["pages.admin.englishName"],value:"offering_en"},{label:e["pages.admin.price"],value:"price"}]},{type:"select",name:"sortOrder",defaultValue:this.pageOptions.sortOrder,tabIndex:"2",options:[{label:e["pages.admin.ascending"],value:"asc"},{label:e["pages.admin.descending"],value:"desc"}]}],this.formGroup=Object(g.d)(this.formConfig,this.formGroup),this.formGroup.get("search").valueChanges.subscribe(e=>{e?(this.pageOptions.search=e,this.getOfferings()):(this.pageOptions.search="",this.getOfferings())}),this.formGroup.get("orderBy").valueChanges.subscribe(e=>{e&&(this.pageOptions.sortBy=e,this.getOfferings())}),this.formGroup.get("sortOrder").valueChanges.subscribe(e=>{e&&(this.pageOptions.sortOrder=e,this.getOfferings())})}getOfferings(){this.offeringsService.getAllOfferings(this.pageOptions).subscribe(e=>{this.offerings=e&&e.data?Object(l.e)(e.data):[]})}addOffering(){const e=[c.d,c.r,c.b].join("/");this.router.navigate([e])}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(s.b),d.Lb(p.a),d.Lb(i.e))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-list"]],decls:14,vars:3,consts:[[1,"w-100","h-100","d-flex","flex-column","offering-list-container"],[1,"row"],[1,"col-12","py-4","text-center"],["translate","",1,"h4"],["class","col-4",4,"ngFor","ngForOf"],[1,"col-12"],[3,"offering","itemDeleted",4,"ngFor","ngForOf"],["class","col-12 pt-4 text-center",4,"ngIf"],["href","javascript:void(0);",1,"floating-add-btn",3,"click"],[1,"col-4"],["appFormElement","",1,"w-100",3,"config","group"],[3,"offering","itemDeleted"],[1,"col-12","pt-4","text-center"],["translate","",1,"h5"]],template:function(e,t){1&e&&(d.Rb(0,"div",0),d.Rb(1,"div",1),d.Rb(2,"div",2),d.Rb(3,"p",3),d.yc(4,"pages.admin.offerings"),d.Qb(),d.Qb(),d.Qb(),d.Rb(5,"div",1),d.wc(6,v,2,2,"div",4),d.Qb(),d.Rb(7,"div",1),d.Rb(8,"div",5),d.wc(9,O,1,1,"app-offering-list-item",6),d.Qb(),d.wc(10,_,3,0,"div",7),d.Qb(),d.Rb(11,"a",8),d.bc("click",function(){return t.addOffering()}),d.Rb(12,"span"),d.yc(13,"+"),d.Qb(),d.Qb(),d.Qb()),2&e&&(d.yb(6),d.ic("ngForOf",t.formConfig),d.yb(3),d.ic("ngForOf",t.offerings),d.yb(1),d.ic("ngIf",!t.offerings||!t.offerings.length))},directives:[i.a,r.j,r.k,u.a,h],styles:[""]}),e})()}];let R=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Jb({type:e}),e.\u0275inj=d.Ib({imports:[[s.e.forChild(y)],s.e]}),e})();var x=n("biST"),D=n("omz/");let Q=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Jb({type:e}),e.\u0275inj=d.Ib({imports:[[r.b,i.c,R,x.a,D.a,a.i]]}),e})()},N26v:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return f}),n.d(t,"f",function(){return c}),n.d(t,"g",function(){return g}),n.d(t,"h",function(){return l}),n.d(t,"e",function(){return d}),n.d(t,"i",function(){return p}),n.d(t,"b",function(){return u}),n.d(t,"d",function(){return m});var r=n("UvjE"),i=n("DFWg"),a=n("wd/R"),s=n("xauc");function o(e){let t=[];return e&&Array.isArray(e)&&(t=e.map(e=>({offering:Number(e.offering.value.id),offeringDate:e.offering.offeringDate?a(Object(s.a)(e.offering.offeringDate)).startOf("day").format(r.c):a().startOf("day").format(r.c),persons:e.persons.map(e=>({name:e.name,star:Number(e.star.value)}))}))),t}function f(e){let t;return e&&(t={offeringEn:e.nameEnglish?e.nameEnglish:"",offeringRg:e.nameRegional?e.nameRegional:e.nameEnglish?e.nameEnglish:"",description:e.description?e.description:"",price:e.amount?Number(e.amount):0}),t}function c(e,t){return e.map(e=>({label:e["offering"+t]?e["offering"+t]:"",value:{id:e.id?e.id:0,label:e["offering"+t]?e["offering"+t]:"",price:e.price?e.price:0}}))}function g(e,t){return e.map(e=>({label:e["star"+t]?e["star"+t]:"",value:{label:e["star"+t]?e["star"+t]:"",value:e.id?e.id:0}}))}function l(e,t){let n=null;return e&&(n={transactionId:e.transaction_id?e.transaction_id:"",transactionStatus:e.transaction_status?e.transaction_status:i.k,transactionDate:e.transaction_time?a(e.transaction_time).format(r.a):"",transactionTime:e.transaction_time?a(e.transaction_time).format(r.d):"",offerings:e.offerings?e.offerings.map(e=>({offering:e["offering"+t]?e["offering"+t]:"",offeringId:e.offering_id?e.offering_id:0,price:e.price?e.price:0,offeringDate:e.offering_date?a(e.offering_date).format(r.a):"",devotees:e.devotees?e.devotees.map(e=>({devoteeId:e.devotee_id?e.devotee_id:0,name:e.name?e.name:"",starId:e.star_id?e.star_id:"",star:e["star"+t]?e["star"+t]:""})):[]})):[]}),n}function d(e){return e.map(e=>({id:e.id?e.id:0,offering_en:e.offering_en?e.offering_en:"",offering_rg:e.offering_rg?e.offering_rg:"",description:e.description?e.description:"",price:e.price?e.price:0}))}function p(e){return{offeringEn:e.offering_en?e.offering_en:"",offeringRg:e.offering_rg?e.offering_rg:"",description:e.description?e.description:"",price:e.price?Number(e.price):0}}function u(e,t){let n=[];return e&&Array.isArray(e)&&(n=e.map(e=>({name:e.name?e.name:"",star:e["star"+t]?e["star"+t]:"",starId:e.star_id?e.star_id:0}))),n}function m(e,t){let n=[];return e&&Array.isArray(e)&&(n=e.map(e=>({offeringId:e.offering_id?e.offering_id:0,offering:e["offering"+t]?e["offering"+t]:"",devoteeId:e.devotee_id?e.devotee_id:0,devotee:e.name?e.name:"",starId:e.star_id?e.star_id:0,star:e["star"+t]?e["star"+t]:"",offeringDate:e.offering_date?a(e.offering_date).format(r.a):"",amount:e.amount?e.amount:0,userId:e.user_id?e.user_id:0,phoneNumber:e.phone_number?e.phone_number:"",bookingDate:e.created_time?a(e.created_time).format(r.a):"",status:e.status?e.status:"",isAdvanceBooking:!(!e.offering_date||!e.created_time)&&a(e.offering_date).isAfter(e.created_time,"day")}))),n}},"o7N+":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("uY3Z"),i=n("xauc"),a=n("fXoL"),s=n("bP2Y");let o=(()=>{class e{constructor(e){this.httpService=e,this.offeringPrefix="offering",this.namePrefix="name",this.starPrefix="star",this.separator="_"}getAllOfferings(e){return this.httpService.httpRequest(e?r.a.offerings+"?page="+e.page+"&limit="+e.limit+"&search="+e.search+"&orderBy="+e.sortBy+"&sortOrder="+e.sortOrder:r.a.offerings,"get")}getAllStars(){return this.httpService.httpRequest(r.a.stars,"get")}getOfferingConfigName(e){return this.offeringPrefix+this.separator+e}getPersonConfigName(e,t){return this.namePrefix+this.separator+e+this.separator+t}getStarConfigName(e,t){return this.starPrefix+this.separator+e+this.separator+t}OfferingDataToCart(e,t){let n=[];if(e)return Object.keys(e).forEach(r=>{const a=r.split(this.separator)[1];if(r.indexOf(this.namePrefix)>-1){const s=r.split(this.separator)[2];let o={offering:null,persons:[]};n[a]=n[a]?n[a]:o,n[a].offering=Object.assign(Object.assign({},e[this.offeringPrefix+this.separator+a]),{offeringDate:t[a].offeringDate?t[a].offeringDate:Object(i.e)()}),n[a].persons[s]={name:e[this.namePrefix+this.separator+a+this.separator+s],star:e[this.starPrefix+this.separator+a+this.separator+s]}}}),n=n.filter(e=>(e.persons=e.persons.filter(e=>null!==e),null!==e)),n}submitUserOffering(e){return this.httpService.httpRequest(r.a.submitOfferings,"post",e)}getTransactionDetails(e){return this.httpService.httpRequest(r.a.transactionDetails+"/"+e,"get")}getTransactionAmount(e){let t=0;return e.offerings.forEach(e=>{t+=e.price*e.devotees.length}),t}completeTransaction(e){return this.httpService.httpRequest(r.a.approveTransaction,"patch",{transactionId:e})}deleteOffering(e){return this.httpService.httpRequest(r.a.offerings+"/"+e.id,"delete")}addOffering(e){return this.httpService.httpRequest(r.a.offerings,e.id?"put":"post",e)}getOfferingDetails(e){return this.httpService.httpRequest(r.a.offerings+"/"+e,"get")}getExistingDevotees(e){return this.httpService.httpRequest(r.a.submitOfferings+"/"+e,"get")}getOfferingsHistory(e,t){let n=r.a.offeringHistory;return n+="?fromDate="+e,n+="&toDate="+t,this.httpService.httpRequest(n,"get")}}return e.\u0275fac=function(t){return new(t||e)(a.Yb(s.a))},e.\u0275prov=a.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);